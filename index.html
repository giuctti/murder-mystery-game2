<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Murder Mystery Game</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
Â  <div class="max-w-4xl mx-auto">
Â  Â  <h1 class="text-3xl font-bold text-center mb-4">ğŸ” Murder Mystery Game</h1>

Â  Â  <section class="mb-8 bg-white p-6 rounded shadow">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-2">The Story</h2>
Â  Â  Â  <p class="text-gray-700">
Â  Â  Â  Â  Last night, at 7:50 PM, a rich man called Mr. Blackwell was found dead in the study room of his big house. The police arrived quickly and started asking questions to the suspects. Seven people were in the house at the time of the murder. Each person knew Mr. Blackwell well, and each person had a reason to be angry with him. David, the gardener, worked for Mr. Blackwell for many years. He liked the garden and cared for the plants every day. Last week, Mr. Blackwell decided to cut many trees without asking David. David felt sad and disrespected. Frank, the musician, often played the piano for Mr. Blackwellâ€™s guests. He loved music, but Mr. Blackwell didnâ€™t pay him very well. Frank wanted to leave the job, but Mr. Blackwell refused and trested him badly. Cynthia, the cook, prepared meals for the house. She cooked delicious food every day. But last month, Mr. Blackwell blamed her for a dinner that the guests didnâ€™t like. He shouted at her in front of everyone. Cynthia felt embarrassed and upset. Rebecca, the teacher, was Mr. Blackwellâ€™s private tutor for his children many years ago. Recently, Mr. Blackwell told her that he planned to send her away because he didnâ€™t need her help anymore. Rebecca felt used and replaceable. Eva, the family doctor, visited the house often because Mr. Blackwell had health problems. Last month, Mr. Blackwell refused to follow her medical advice and blamed her for his pain, humilliating her. Eva felt tired and frustrated. Susan, the librarian, organized Mr. Blackwellâ€™s private library. She loved books and worked quietly. But Mr. Blackwell wanted to sell some of the rare books, and Susan disagreed, which made her feel angry. Every person seemed calm, but also nervous. Everyone had a reason to hate Mr. Blackwell. Now, the police must discover who told the truthâ€¦ and who lied. The mystery begins.
Â  Â  Â  </p>
Â  Â  </section>

Â  Â  <section class="mb-8">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Suspects</h2>
Â  Â  Â  <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="suspect-grid"></div>
Â  Â  </section>

Â  Â  <div id="question-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
Â  Â  Â  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
Â  Â  Â  Â  <h3 class="text-xl font-bold mb-4" id="modal-title">Ask a Question</h3>
Â  Â  Â  Â  <ul id="modal-word-bank" class="flex gap-2 flex-wrap p-4 bg-gray-100 rounded mb-4 min-h-[60px]"></ul>
Â  Â  Â  Â  <button onclick="checkModalQuestion()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Check</button>
Â  Â  Â  Â  <p id="modal-result" class="mt-2 font-bold"></p>
Â  Â  Â  Â  <button id="next-question-btn" onclick="nextModalQuestion()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hidden">Next</button>
Â  Â  Â  Â  <button onclick="closeModal()" class="mt-4 text-sm text-red-500 underline">Close</button>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <section class="mb-8">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Killer's Timeline</h2>
Â  Â  Â  <p class="mb-2 text-gray-600">Write what happened between 7:40 and 7:50:</p>
Â  Â  Â  <form id="timeline-form" class="bg-white rounded-lg shadow p-4 space-y-4">
Â  Â  Â  Â  <div><label class="block font-semibold">7:40 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time1"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:45 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time2"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:47 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time3"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:50 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time4"></div>
Â  Â  Â  Â  <button type="button" onclick="checkTimeline()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Check</button>
Â  Â  Â  Â  <p id="timeline-result" class="mt-2 font-bold"></p>
Â  Â  Â  </form>
Â  Â  </section>

Â  Â  <section>
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Who Did It?</h2>
Â  Â  Â  <p class="text-gray-600 mb-2">Choose the killer:</p>
Â  Â  Â  <select id="killer-guess" class="w-full max-w-xs p-2 border border-gray-300 rounded">
Â  Â  Â  Â  <option value="">-- Choose --</option>
Â  Â  Â  Â  <option>Cynthia</option>
Â  Â  Â  Â  <option>David</option>
Â  Â  Â  Â  <option>Rebecca</option>
Â  Â  Â  Â  <option>Eva</option>
Â  Â  Â  Â  <option>Frank</option>
Â  Â  Â  Â  <option>Susan</option>
Â  Â  Â  </select>
Â  Â  Â  <button onclick="checkKillerGuess()" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Submit</button>
Â  Â  Â  <p id="killer-result" class="mt-2 font-bold"></p>
Â  Â  </section>
Â  </div>

Â  <script>
    // Variable global para almacenar la instancia de Sortable.js
    let currentSortable = null;
    
Â  Â  const suspects = [
Â  Â  Â  {
Â  Â  Â  Â  name: 'Cynthia',
Â  Â  Â  Â  job: 'Cook',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At 7:40, I was cooking dinner in the kitchen.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I saw someone walking fast to the study room.',
Â  Â  Â  Â  Â  q3: 'At 7:47, the lights went off, and I heard a scream.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I stayed in the kitchen.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'David',
Â  Â  Â  Â  job: 'Gardener',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'I was in the garden.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I didn\'t see anyone, but I heard a loud noise.',
Â  Â  Â  Â  Â  q3: 'At 7:47, I saw the lights go off, and someone screamed.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I went inside the house.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Eva',
Â  Â  Â  Â  job: 'Doctor',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At 7:40, I was in the living room, writing a medical file.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I went outside to talk to David.',
Â  Â  Â  Â  Â  q3: 'At 7:47, the lights went off. I was really scared.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I went to my room.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Rebecca',
Â  Â  Â  Â  job: 'Teacher',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At 7:40, I was reading a book in the hall.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I saw Cynthia cooking in the kitchen.',
Â  Â  Â  Â  Â  q3: 'At 7:47, the lights went off, and I heard a scream in the study room.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I went to the study room, and I found Mr. Blackwell\'s body.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Frank',
Â  Â  Â  Â  job: 'Musician',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At 7:40, I was playing the electric guitar in the music room.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I saw David alone in the garden.',
Â  Â  Â  Â  Â  q3: 'At 7:47, the lights went off.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I stayed in the music room.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Susan',
Â  Â  Â  Â  job: 'Librarian',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At 7:40, I was in the library, organizing books.',
Â  Â  Â  Â  Â  q2: 'At 7:45, I saw Eva near the study room.',
Â  Â  Â  Â  Â  q3: 'At 7:47, I heard a scream after the lights went off.',
Â  Â  Â  Â  Â  q4: 'At 7:50, I stayed in the library.'
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  ];

Â  Â  const allQuestions = [
Â  Â  Â  'Where were you at 7:40?',
Â  Â  Â  'What did you see at 7:45?',
Â  Â  Â  'What happened at 7:47?',
Â  Â  Â  'Where were you at 7:50?'
Â  Â  ];

Â  Â  let currentSuspect = null;
Â  Â  let currentQuestionIndex = 0;

Â  Â  const suspectGrid = document.getElementById('suspect-grid');
Â  Â  suspects.forEach((s) => {
Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  div.className = 'bg-white p-4 rounded shadow text-center cursor-pointer hover:bg-blue-100';
Â  Â  Â  div.onclick = () => openModal(s);
Â  Â  Â  div.innerHTML = `<h3 class='font-bold text-lg'>${s.name}</h3><p class='text-sm text-gray-600'>${s.job}</p>`;
Â  Â  Â  suspectGrid.appendChild(div);
Â  Â  });

Â  Â  function openModal(suspect) {
Â  Â  Â  currentSuspect = suspect;
Â  Â  Â  currentQuestionIndex = 0;
Â  Â  Â  document.getElementById('modal-result').textContent = '';
Â  Â  Â  loadModalQuestion();
Â  Â  Â  document.getElementById('question-modal').classList.remove('hidden');
Â  Â  }

Â  Â  function loadModalQuestion() {
Â  Â  Â  document.getElementById('modal-title').textContent = `Ask ${currentSuspect.name}`;
Â  Â  Â  const bank = document.getElementById('modal-word-bank');
Â  Â  Â  bank.innerHTML = '';
Â  Â  Â  document.getElementById('next-question-btn').classList.add('hidden');

      // 1. DESTRUYE la instancia anterior de Sortable si existe.
      if (currentSortable) {
          currentSortable.destroy();
          currentSortable = null; 
      }

Â  Â  Â  // Separamos el signo de interrogaciÃ³n de la Ãºltima palabra para que sea un bloque individual
Â  Â  Â  const questionWithoutPunctuation = allQuestions[currentQuestionIndex].slice(0, -1);
Â  Â  Â  let selectedWords = questionWithoutPunctuation.split(' ');
Â  Â  Â  selectedWords.push('?'); // Agregamos el signo de interrogaciÃ³n como una palabra/bloque mÃ¡s

Â  Â  Â  shuffle(selectedWords);
Â  Â  Â  selectedWords.forEach(word => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.textContent = word;
Â  Â  Â  Â  li.className = 'px-3 py-2 bg-blue-100 rounded cursor-move';
Â  Â  Â  Â  bank.appendChild(li);
Â  Â  Â  });
      
      // 2. CREA la nueva instancia de Sortable y guÃ¡rdala.
Â  Â  Â  currentSortable = Sortable.create(bank, { animation: 150 });
Â  Â  }

Â  Â  function checkModalQuestion() {
Â  Â  Â  const words = [...document.getElementById('modal-word-bank').children].map(li => li.textContent);
Â  Â  Â  
Â  Â  Â  // Unimos las palabras y luego reemplazamos " ?" por "?" para corregir el formato.
Â  Â  Â  let userQuestion = words.join(' ');
Â  Â  Â  userQuestion = userQuestion.replace(' ?', '?').trim(); 

Â  Â  Â  const expected = allQuestions[currentQuestionIndex].trim();
Â  Â  Â  const result = document.getElementById('modal-result');

Â  Â  Â  if (userQuestion === expected) { 
Â  Â  Â  Â  const answer = currentSuspect.responses[`q${currentQuestionIndex + 1}`];
Â  Â  Â  Â  result.textContent = `${currentSuspect.name} said: \"${answer}\"`;
Â  Â  Â  Â  document.getElementById('next-question-btn').classList.remove('hidden');
Â  Â  Â  } else {
Â  Â  Â  Â  result.textContent = 'âŒ Try again.';
Â  Â  Â  }
Â  Â  }


Â  Â  function nextModalQuestion() {
Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  if (currentQuestionIndex >= allQuestions.length) {
Â  Â  Â  Â  closeModal();
Â  Â  Â  } else {
Â  Â  Â  Â  document.getElementById('modal-result').textContent = '';
Â  Â  Â  Â  loadModalQuestion();
Â  Â  Â  }
Â  Â  }

Â  Â  function closeModal() {
Â  Â  Â  document.getElementById('question-modal').classList.add('hidden');
      // Destruye la instancia al cerrar el modal tambiÃ©n
      if (currentSortable) {
          currentSortable.destroy();
          currentSortable = null;
      }
Â  Â  }

Â  Â  function checkTimeline() {
Â  Â  Â  // Oraciones correctas actualizadas
Â  Â  Â  const expected = [
Â  Â  Â  Â  'Eva was in the living room.', 
Â  Â  Â  Â  'Eva went to the study room.', 
Â  Â  Â  Â  'Eva turned off the lights and killed Mr. Blackwell.', 
Â  Â  Â  Â  'Rebecca found the body.'
Â  Â  Â  ];

Â  Â  Â  // Solo 4 entradas de tiempo (7:40, 7:45, 7:47, 7:50)
Â  Â  Â  const userAnswers = [
Â  Â  Â  Â  document.getElementById('time1').value.trim(),
Â  Â  Â  Â  document.getElementById('time2').value.trim(),
Â  Â  Â  Â  document.getElementById('time3').value.trim(),
Â  Â  Â  Â  document.getElementById('time4').value.trim()
Â  Â  Â  ];

Â  Â  Â  const result = document.getElementById('timeline-result');
Â  Â  Â  // Comprueba que la longitud de las respuestas sea la misma y que todas sean correctas
Â  Â  Â  const isCorrect = userAnswers.length === expected.length && userAnswers.every((ans, i) => ans.toLowerCase() === expected[i].toLowerCase());

Â  Â  Â  result.textContent = isCorrect ? 'âœ… Correct timeline!' : 'âŒ Try again.';
Â  Â  }

Â  Â  function checkKillerGuess() {
Â  Â  Â  const guess = document.getElementById('killer-guess').value;
Â  Â  Â  const result = document.getElementById('killer-result');
Â  Â  Â  result.textContent = guess === 'Eva' ? `âœ… Correct! ${guess} is the killer.` : `âŒ No, ${guess} is not the killer.`;
Â  Â  }

Â  Â  function shuffle(arr) {
Â  Â  Â  for (let i = arr.length - 1; i > 0; i--) {
Â  Â  Â  Â  const j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  [arr[i], arr[j]] = [arr[j], arr[i]];
Â  Â  Â  }
Â  Â  }
Â  </script>
</body>
</html>


